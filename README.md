# Spanish Speaking Practice Telegram Bot

Telegram bot for Spanish speaking practice. Get daily prompts in English, respond with voice messages in Spanish, receive feedback.

## Setup

### Prerequisites

- Node.js 20+
- PostgreSQL
- API keys: Telegram Bot ([@BotFather](https://t.me/BotFather)), [ElevenLabs](https://elevenlabs.io), [OpenAI](https://platform.openai.com)

### Environment Variables

```bash
cp .env.example .env
```

Required:
- `BOT_TOKEN` - Telegram bot token
- `ELEVENLABS_API_KEY` - for speech-to-text
- `OPENAI_API_KEY` - for GPT analysis
- `DATABASE_URL` - PostgreSQL connection string

Optional:
- `WEBHOOK_DOMAIN` - required for production webhook mode
- `PORT` - server port (default: 3000)
- `NODE_ENV` - `development` (polling) or `production` (webhook)

### Run Locally

```bash
pnpm install
pnpm dev
```

### Run with Docker

```bash
docker-compose up -d
```

## Commands

| Command | Description |
|---------|-------------|
| `/start` | Register |
| `/new` | Get a practice prompt |
| `/settings` | Change time, difficulty, timezone |
| `/help` | Show help |

## How It Works

1. Scheduler sends daily prompts at user's preferred hour (UTC)
2. Prompts are generated by GPT based on current news headlines
3. User sends voice message in Spanish
4. ElevenLabs transcribes the audio
5. GPT analyzes transcription and provides feedback (mistakes, corrections, tips)

## Project Structure

```
src/
├── index.ts           # Entry point
├── bot.ts             # Bot setup
├── services/          # ElevenLabs, OpenAI, news, scheduler
├── handlers/          # Command, voice, callback handlers
├── prompts/           # GPT system prompts
├── db/                # PostgreSQL schema and queries
└── types/             # TypeScript types
```
